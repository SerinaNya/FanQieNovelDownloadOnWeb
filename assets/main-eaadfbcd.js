import{_ as A,r as a,o as O,a as d,c as u,b as e,t as V,w as r,v as R,d as P,e as S,f as y,u as _,g as U,h as p,F as L,i as q,p as C,j as N,k as j}from"./bootstrap.min-045aca3c.js";import{a as M}from"./axios-47b9d439.js";const E="/assets/setting.png";const l=f=>(C("data-v-53b29f25"),f=f(),N(),f),K=l(()=>e("img",{src:E,alt:"Your Image",class:"img-fluid",style:{width:"30px",height:"30px"},"data-bs-toggle":"modal","data-bs-target":"#settingModal"},null,-1)),W={class:"modal fade",id:"settingModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},X={class:"modal-dialog"},Y={class:"modal-content"},z=l(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"设置"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),G={class:"modal-body"},H=l(()=>e("p",null,[p("您使用本软件即代表您同意最终用户许可协议("),e("a",{href:"/eula"},"此处"),p(")")],-1)),J=l(()=>e("p",null,"© 2022-2023 FlyStudioKey. All Rights Reserved.",-1)),Q=l(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"关闭")],-1)),Z={key:0,class:"container d-flex justify-content-center align-items-center centered-div"},$={class:"text-center"},ee=l(()=>e("h1",{class:"display-4"},"番茄小说下载器",-1)),te={class:"form-check form-check-inline"},le=l(()=>e("label",{class:"form-check-label",for:"singleDownload"},"单文件下载",-1)),se={class:"form-check form-check-inline"},oe=l(()=>e("label",{class:"form-check-label",for:"bulkDownload"},"批量下载",-1)),ae={class:"mt-3"},ne=l(()=>e("label",{for:"formatOption"},"文件格式：",-1)),ie=l(()=>e("option",{value:"txt"},"TXT(普通文档)",-1)),de=l(()=>e("option",{value:"epub"},"EPUB(电子书)",-1)),ue=[ie,de],re={key:0,class:"mt-3 url-box"},ce=l(()=>e("label",{for:"urlInput"},"URL：",-1)),_e={key:1,class:"mt-3 url-box"},pe=l(()=>e("label",{for:"bulkUrlInput"},"URL（每行一个）：",-1)),ve={key:3,class:"btn btn-secondary mt-3",disabled:""},he=l(()=>e("br",null,null,-1)),fe=l(()=>e("br",null,null,-1)),me={class:"alert alert-success"},be=l(()=>e("strong",null,"稍等！",-1)),ge={class:"alert alert-success"},ye=l(()=>e("strong",null,"成功!",-1)),we={class:"alert alert-warning"},ke=l(()=>e("strong",null,"警告!",-1)),xe={class:"alert alert-warning"},Ue=l(()=>e("strong",null,"警告!",-1)),De=l(()=>e("button",{class:"btn btn-primary mt-3"},[e("a",{href:"/history",style:{"text-decoration":"none",color:"inherit"}},"下载任务")],-1)),Ie={__name:"App",setup(f){const T=a(!0);let m=a(!1),b=a(!1),g=a(!1),c=a(!0),w=a([]);a([]);const n=a("single"),i=a(""),k=a(""),v=a("epub"),x=a("");document.title="番茄小说下载器";let h=[];const B=async()=>{if(m.value=!1,b.value=!1,g.value=!1,c.value=!1,n.value==="single")if(console.log("Downloading single file:",i.value),D(i.value)&&(i.value.includes("/page/")||i.value.includes("&book_id="))){console.log("Downloading single file:",i.value);let o=await I([i.value],v.value);o.data.return.length>0?(w.value=o.data.return,g.value=!0):(m.value=!0,c.value=!0)}else b.value=!0,c.value=!0;else if(n.value==="bulk")if(h=k.value.split(`
`),console.log("Downloading multiple files:",h),h.every(t=>D(t)&&(t.includes("/page/")||t.includes("&book_id=")))){console.log("Downloading multiple files:",h);let t=await I(h,v.value);t.data.return.length>0?(w.value=t.data.return,g.value=!0):(m.value=!0,c.value=!0)}else b.value=!0,c.value=!0};function D(o){return/^https?:\/\/.+/.test(o)}async function I(o,t){try{const s=await M.post("/api/down/",{urls:o,format:t});return console.log("POST request successful:",s.data),s}catch(s){console.error("POST request failed:",s)}}const F=async()=>{try{const o=await M.get("/api/get_config/");console.log(o.data),v.value=o.data.default_download_mode,x.value=o.data.version,console.log("Fetched config:",x.value)}catch(o){console.error("Failed to fetch history data:",o)}};return O(()=>{F()}),(o,t)=>(d(),u(L,null,[K,e("div",W,[e("div",X,[e("div",Y,[z,e("div",G,[e("p",null,"当前版本： "+V(x.value),1),H,J]),Q])])]),T.value?(d(),u("div",Z,[e("div",$,[ee,e("div",te,[r(e("input",{class:"form-check-input",type:"radio",name:"downloadType",id:"singleDownload",value:"single","onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s)},null,512),[[R,n.value]]),le]),e("div",se,[r(e("input",{class:"form-check-input",type:"radio",name:"downloadType",id:"bulkDownload",value:"bulk","onUpdate:modelValue":t[1]||(t[1]=s=>n.value=s)},null,512),[[R,n.value]]),oe]),e("div",ae,[ne,r(e("select",{class:"form-control",id:"formatOption","onUpdate:modelValue":t[2]||(t[2]=s=>v.value=s)},ue,512),[[P,v.value]])]),n.value==="single"?(d(),u("div",re,[ce,r(e("input",{type:"text",class:"form-control",id:"urlInput","onUpdate:modelValue":t[3]||(t[3]=s=>i.value=s),placeholder:"输入URL"},null,512),[[S,i.value]])])):y("",!0),n.value==="bulk"?(d(),u("div",_e,[pe,r(e("textarea",{class:"form-control",id:"bulkUrlInput",rows:"5","onUpdate:modelValue":t[4]||(t[4]=s=>k.value=s),placeholder:"输入多个URL，每行一个"},null,512),[[S,k.value]])])):y("",!0),_(c)?(d(),u("button",{key:2,class:"btn btn-primary mt-3",onClick:B},"提交")):(d(),u("button",ve,"提交")),he,fe,r(e("div",me,[be,p(" 正在尝试获取信息！ ")],512),[[U,!_(c)]]),r(e("div",ge,[ye,p(" 加入下载列表！ ")],512),[[U,_(m)]]),r(e("div",we,[ke,p(" 请输入正确的目录链接！ ")],512),[[U,_(b)]]),_(g)?(d(!0),u(L,{key:4},q(_(w),s=>(d(),u("div",xe,[Ue,p(" "+V(s)+" 重复提交 ",1)]))),256)):y("",!0)]),De])):y("",!0)],64))}},Ve=A(Ie,[["__scopeId","data-v-53b29f25"]]);j(Ve).mount("#app");
