import{_ as k,r as c,o as m,a as s,c as a,b as o,F as y,i as w,w as F,g as S,u as p,t as _,n as x,h as I,p as A,j as D,k as $}from"./bootstrap.min-045aca3c.js";import{a as l}from"./axios-47b9d439.js";const B=r=>(A("data-v-6f0c16ad"),r=r(),D(),r),C=B(()=>o("div",{class:"title"},[o("h1",{class:"display-4"},"下载任务")],-1)),L={class:"centered-div"},N={class:"progress"},V={class:"progress-div"},j=["href"],z={key:1,class:"btn btn-secondary",disabled:""},E={key:2,class:"btn btn-secondary mt-3",disabled:""},H=["onClick"],M={class:"alert alert-success"},P={__name:"App",setup(r){const i=c([]);let d=c(!1),u=c(""),h=c("");document.title="番茄小说下载器 | 下载任务";const f=async(e,n)=>{d.value=!1;try{const t=await l.get(`/api/down/del/${e}/`);d.value=!0,location.reload()}catch(t){console.error("Failed to fetch history data:",t)}},v=async()=>{try{const e=await l.get("/api/history/");i.value=e.data,console.log(e.data),console.log(typeof e.data),g()}catch(e){console.error("Failed to fetch history data:",e)}},g=()=>{setInterval(async()=>{for(const e of i.value.history)if(e.percent!==100)try{const n=await l.get(`/api/history/${e.obid}/`);e.percent=n.data.percent,console.log(e.percent)}catch(n){console.error("Failed to fetch progress:",n),location.reload()}},800)},b=async()=>{try{const e=await l.get("/api/get_config/");console.log(e.data),h.value=e.data.download_url,version.value=e.data.version}catch(e){console.error("Failed to fetch history data:",e)}};return m(()=>{b(),v()}),(e,n)=>(s(),a(y,null,[C,o("div",L,[(s(!0),a(y,null,w(i.value.history,t=>(s(),a("div",{key:t.obid,class:"history-item"},[o("h2",null,_(t.file_name),1),o("div",N,[o("div",{class:"progress-bar",style:x({width:`${t.percent}%`})},null,4)]),o("div",V,[I(_(t.percent)+"% ",1),t.percent===100?(s(),a("a",{key:0,href:p(h)+t.file_name,class:"btn btn-primary"}," 下载 ",8,j)):(s(),a("button",z," 下载 ")),t.percent===100?(s(),a("button",E,"删除")):(s(),a("button",{key:3,class:"btn btn-danger mt-3",onClick:q=>f(t.obid,t.file_name)},"删除",8,H))])]))),128)),F(o("div",M,[o("strong",null,_(p(u))+" 删除成功!",1)],512),[[S,p(d)]])])],64))}},T=k(P,[["__scopeId","data-v-6f0c16ad"]]);$(T).mount("#app");
